---
layout: post
title:  Defensive Coding
tags: code
categories: youtube
---

주말에 널부러져있다가, 카페에서 멍때리고 봤던 [유투브 영상](https://www.youtube.com/watch?v=yBgvkO-GtFk)에 대한 정리 글 입니다.

#### 주의

> 개인 회고 및 동기들과 이야기 주제로 재밌을거 같아서 정리한 글로, 개인적인 생각이 섞인 글 입니다. 되도록이면 영상을 보는걸 추천드립니다.

추가적으로 저는 Java/ Spring 을 주언어로 사용하는 개발자 입니다.
때문에 영상에서 말하는 분과는 상황/환경이 다를 수 있습니다.


#### 방어적 프로그래밍

영상에서는 5가지의 기준점을 가지고 각각의 기법들이 적합한지 혹은 효율적인지를 말합니다.

> 5가지의 기준점은 아래와 같습니다.

```
1. 프로그래머의 실수를 예방할 수 있는가 ?
2. 실수 빨리 찾을 수 있는가 ?
3. 시간 낭비 줄이는가 ?
4. 적당한 지적 수준에서 이해할 수 있는가 ?
5. 문제가 발생한 곳을 바로 찾을 수 있는가 ?
```

> 꼭 영상에서 말하는 주제가 아니더라도, 다른 영역에 대입해봐도 좋을듯 합니다.


#### 1. 예외처리

예외처리는 작성자가 제어하지 못하는 상황에서만 쓰이는게 올바르다고 말합니다.

> 제어하지 못하는 상황이라 함은 외부팀의 API 혹은 DB , File Read등 과 같은 상황을 말합니다.

예외처리 자체는 사실 위 5가지 기준에 대부분 부합하지 않습니다.
잘못된 예외처리는 에러 범위를 찾는데 시간을 더 소모하게되고 문제가 발생한 곳을 바로 찾기도 어렵습니다.

그래서 영상에서는 예외나 유효성 검사등의 로직은 경계 범위에서만 딱 한번 검증되면 된다고 말합니다.

> 개인적으로 이 말에 크게 공감하고 있고, 내일 출근하면 적용해봐야겟다 라는 생각을 하고 있습니다.

controller단이나, DB에서 데이터를 가져올 때 딱 한번 Validation check 나 Exception handling 을 하게되면 내가 작성한 로직 내부에선 중복해서 검사할 필요가 없어질 수도 있고 try-catch를 쓸 일이 적어지겠다 라는 생각을 하고있습니다.

> 만약 controller 나 DB가 아닌 내부 로직을 수정한다 라고 했을 땐 어떻게 경계범위를 정하고 검사를 해야할까 고민을 하고 있습니다.


#### 2. DI

이 부분은 DI != IOC 라는 말과 코드를 한눈에 보기 힘들다 정도가 공감이 갔습니다.

하나의 Interface 에 여러가지 구현 클래스가 있다면 한눈에 파악하기 어려운건 사실 이니까요.

> 다만 TC가 있다면 괜찮지 않을까 라는 생각을 하고 있습니다 .

Code configuration 으로 바뀌면서 컴파일 단에서도 검증을 할 수 있다고 생각하고, DI 의 장점인 관계의 재사용이라는 측면에서 좋다고 생각됩니다.

> 이 부분은 이야기 한번 해보죠


#### 3. String - Enum

이건 당연한 부분이라고 생각됩니다.
예상되는 문자열 넘어와야하는 경우, Enum을 쓰는게 맞고 String은 예상치 못한 Data가 넘어올 경우 처리하기 어려우므로 사용하지 않는게 좋을듯 합니다.

> Enum 의 장점 컴파일 단에서 확인 가능, 유효성 검증 좋음


#### 4. null 처리

실수를 많이할 수도 있고, 코드 앞단에 계속 null checking을 하는건 좋지 않음.

만약 null을 반환 할 수도있다면, 함수 이름에다가 명시를 해줘야한다.

> 함수에 null 이 적힌 코드는 못봤는데 나름 신선했다.

1 번과 마찬가지로, 내가 짠 코드에서는 null 체크를 한번만 하고 이후에는 하지 않는게 좋다.

#### 5. magic number

의미가 있는 숫자는 `const MAX = 500;` 과 같이 빼는게 좋음

> 이견 없음

#### 6. if 문

depth가 길어질 경우를 대비해, return 문을 앞으로 빼는게 좋다.

> 난 개인적으로 이 방식을 선호하는데, 영상에서도 나오듯, 사람은 위에서 아래로 코드를 읽는다.

때문에 return 조건을 위로 빼면, 아 이 경우엔 함수가 돌지 않는구나 를 한번에 알 수 있다.


> 읽기도 쉬워지고 depth도 줄어듦 여지가 있다.

#### 7. TDD

TDD는 사실 애매하다고 생각된다.
개발을 하면서 TC가 만들어지는건 좋다고 생각됨.
다만, 영상에서 말하듯 TC를 짜는 사람이 비즈니스 로직을 잘못알고 있으면 애초에 잘못된 TC고 의미없는 것이 된다.

> 개인적으로는 개발을 하고 회고 형식으로 TC를 짜는게 더 좋다고 생각된다.


2018.11.25   
1차 초안







-
